operations:
  - create_table:
      name: "grupos"
      columns:
        - name: "id"
          type: "text"
          pk: true
        - name: "nombre"
          type: "text"
          nullable: false

  - create_table:
      name: "participantes"
      columns:
        - name: "id"
          type: "text"
          pk: true
        - name: "nombre"
          type: "text"
          nullable: false
        - name: "grupo__id"
          type: "text"
          nullable: false
          references:
            table: "grupos"
            column: "id"
            name: "fk_participantes_grupo__id"

  - create_table:
      name: "distribuciones"
      columns:
        - name: "id"
          type: "text"
          pk: true
        - name: "tipo"
          type: "text"
          nullable: false
  - create_table:
      name: "distribuciones_monto_equitativo"
      constraints:
        - name: "distribucion__id__id__unique"
          type: unique
          columns:
            - id
            - distribucion__id
      columns:
        - name: "id"
          type: "text"
          pk: true
        - name: "distribucion__id"
          type: "text"
          nullable: false
          unique: true
          references:
            table: "distribuciones"
            column: "id"
            name: "fk_distribuciones_monto_equitativo_distribuciones__id"
            on_delete: CASCADE
  - create_table:
      name: "distribuciones_monto_equitativo_items"
      constraints:
        - name: "distribucion__id__participante__id__unique"
          type: unique
          columns:
            - distribucion__id
            - participante__id
      columns:
        - name: "distribucion__id"
          type: "text"
          nullable: false
          references:
            table: "distribuciones_monto_equitativo"
            column: "id"
            name: "fk_monto_equitativo_item_monto_equitativo__id"
            on_delete: CASCADE
        - name: "participante__id"
          type: "text"
          nullable: false
          references:
            table: "participantes"
            column: "id"
            name: "fk_monto_equitativo_item_participante__id"

  - create_table:
      name: "pagos"
      columns:
        - name: "id"
          type: "text"
          pk: true
        - name: "grupo__id"
          type: "text"
          nullable: false
          references:
            table: "grupos"
            column: "id"
            name: "fk_pagos_grupo__id"
        - name: "distribucion_pagadores__id"
          type: "text"
          nullable: false
          references:
            table: "distribuciones"
            column: "id"
            name: "fk_pagos_distribuciones_pagadores__id"
        - name: "distribucion_deudores__id"
          type: "text"
          nullable: false
          references:
            table: "distribuciones"
            column: "id"
            name: "fk_pagos_distribuciones_deudores__id"
        - name: is_valid
          type: boolean
          nullable: false
          default: "false"
        - name: "nombre"
          type: "text"
          nullable: false
        - name: "monto__lugares_despues_de_la_coma"
          type: "int"
          nullable: false
        - name: "monto__valor"
          type: "bigint"
          nullable: false

  - create_table:
      name: "partes_deudores"
      columns:
        - name: "id"
          type: "uuid"
          pk: true
          # TODO: Generate this in haskell and use text
          default: "gen_random_uuid()"
        - name: "pago__id"
          type: "text"
          nullable: false
          references:
            table: "pagos"
            column: "id"
            name: "fk_partes_deudores_pago_id"
        - name: "participante__id"
          type: "text"
          nullable: false
          references:
            table: "participantes"
            column: "id"
            name: "fk_partes_deudores_participante_id"
        - name: "tipo"
          type: "text"
          nullable: false
        - name: "monto__lugares_despues_de_la_coma"
          type: "int"
          nullable: true
        - name: "monto__valor"
          type: "bigint"
          nullable: true
        - name: "cuota"
          type: "bigint"
          nullable: true

  - create_table:
      name: "partes_pagadores"
      columns:
        - name: "id"
          type: "uuid"
          pk: true
          # TODO: Generate this in haskell and use text
          default: "gen_random_uuid()"
        - name: "pago__id"
          type: "text"
          nullable: false
          references:
            table: "pagos"
            column: "id"
            name: "fk_partes_pagadores_pago__id"
        - name: "participante__id"
          type: "text"
          nullable: false
          references:
            table: "participantes"
            column: "id"
            name: "fk_partes_pagadores_participante__id"
        - name: "tipo"
          type: "text"
          nullable: false
        - name: "monto__lugares_despues_de_la_coma"
          type: "int"
          nullable: true
        - name: "monto__valor"
          type: "bigint"
          nullable: true
        - name: "cuota"
          type: "bigint"
          nullable: true

  - create_table:
      name: "repartijas"
      constraints:
        - name: "repartijas__distribucion__id__id__unique"
          type: unique
          columns:
            - id
            - distribucion__id
      columns:
        - name: "id"
          type: "text"
          pk: true
        - name: "distribucion__id"
          type: "text"
          nullable: false
          unique: true
          references:
            table: "distribuciones"
            column: "id"
            name: "fk_repartijas_distribucion__id"
            on_delete: CASCADE
        - name: "extra__lugares_despues_de_la_coma"
          type: "int"
          nullable: false
        - name: "extra__valor"
          type: "bigint"
          nullable: false

  - create_table:
      name: "repartija_items"
      columns:
        - name: "id"
          type: "text"
          pk: true
        - name: "repartija__id"
          type: "text"
          nullable: false
          references:
            table: "repartijas"
            column: "id"
            name: "fk_repartijas_items_repartija__id"
            on_delete: CASCADE
        - name: "nombre"
          type: "text"
          nullable: false
        - name: "monto__lugares_despues_de_la_coma"
          type: "int"
          nullable: false
        - name: "monto__valor"
          type: "bigint"
          nullable: false
        - name: "cantidad"
          type: "integer"
          nullable: false

  - create_table:
      name: "repartija_claims"
      constraints:
        - name: "repartija_item_id__repartija_participante__unique"
          type: unique
          columns:
            - participante__id
            - repartija_item__id
      columns:
        - name: "id"
          type: "text"
          pk: true
        - name: "participante__id"
          type: "text"
          nullable: false
          references:
            table: "participantes"
            column: "id"
            name: "fk_repartijas_claims_participante__id"
        - name: "repartija_item__id"
          type: "text"
          nullable: false
          references:
            table: "repartija_items"
            column: "id"
            name: "fk_repartijas_claims_repartija_item__id"
            on_delete: CASCADE
        - name: "cantidad"
          type: "integer"
          nullable: true
